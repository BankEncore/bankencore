<!DOCTYPE html>
<html lang="en" data-theme="corporate">
  <head>
    <title><%= content_for?(:title) ? yield(:title) : "YourApp" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    <script>
      (function(){
        const KEY='daisy-theme',root=document.documentElement,saved=localStorage.getItem(KEY);
        if(saved) root.setAttribute('data-theme',saved);
        document.addEventListener('change',function(e){
          const t=e.target;
          if(t && t.classList && t.classList.contains('theme-controller')){
            const val=t.value; root.setAttribute('data-theme',val);
            try{localStorage.setItem(KEY,val);}catch(_){}
          }
        });
        document.addEventListener('DOMContentLoaded',function(){
          const current=root.getAttribute('data-theme')||'corporate';
          document.querySelectorAll('.theme-controller').forEach(function(el){
            el.checked=(el.value===current);
          });
        });
      })();
    </script>
  </head>

  <body>
    <div class="max-w-7xl mx-auto flex items-center justify-between px-4 md:px-6 py-3">
      <%= link_to root_path, class: "flex items-center gap-2" do %>
        <svg ... aria-label="BankEncoRRe"></svg>
      <% end %>

      <nav class="hidden md:flex items-center space-x-2" role="navigation" aria-label="Main">
        <%= link_to "Home", root_path, class: "btn btn-ghost btn-sm" %>
        <%= link_to "Parties", party_parties_path, class: "btn btn-ghost btn-sm" %>
        <%= link_to "Cases", "#", class: "btn btn-ghost btn-sm" %>
        <%= link_to "Reports", "#", class: "btn btn-ghost btn-sm" %>
      </nav>

      <div class="flex items-center gap-3">
        <%= form_with url: party_parties_path, method: :get, local: true, class: "join" do %>
          <input name="q" aria-label="Search parties" class="input input-bordered join-item w-64 md:w-80" placeholder="Search by name, email, or #" />
          <button class="btn join-item" type="submit">Search</button>
        <% end %>

        <%= link_to "New Party", new_party_party_path, class: "btn btn-primary btn-sm hidden md:inline-flex" %>

        <div class="dropdown dropdown-end">
          <button tabindex="0" class="btn btn-ghost btn-circle avatar btn-sm" aria-label="User menu">
            <div class="w-8 rounded-full bg-base-300"></div>
          </button>
          <div tabindex="0" class="dropdown-content z-10 bg-base-100 rounded-box shadow p-3 w-64">
            <div class="mb-2 text-sm font-semibold">Appearance</div>
            <div class="grid grid-cols-2 gap-2 text-sm">
              <% ["corporate","business","light","dark","emerald","retro","autumn","wireframe"].each do |t| %>
                <label class="label cursor-pointer justify-start gap-2">
                  <input type="radio" name="theme" value="<%= t %>" class="theme-controller" />
                  <span><%= t.capitalize %></span>
                </label>
              <% end %>
            </div>
            <div class="divider my-2"></div>
            <ul class="menu">
              <li><a href="#">Profile</a></li>
              <li><a href="#">Sign out</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <main class="container mx-auto p-6">
      <% flash.each do |type, msg| %>
        <% tone = { notice: "info", alert: "warning", error: "error", success: "success" }[type.to_sym] || "info" %>
        <div class="alert alert-<%= tone %> mb-3"><%= msg %></div>
      <% end %>
      <%= yield %>
    </main>

    <footer class="border-t">
      <div class="container mx-auto p-4 text-sm opacity-70">
        © <%= Time.current.year %> YourApp · <a href="#" class="link">Privacy</a>
      </div>
    </footer>
  </body>
</html>
