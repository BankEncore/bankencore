<section id="<%= dom_id(party, :addresses_section) %>" class="space-y-2">
  <div class="flex items-center justify-between">
    <h3 class="font-semibold">Addresses</h3>
    <%= link_to "Add",
      new_party_party_address_path(party.public_id, from: :show),
      data: { turbo_frame: "comm_modal_frame", action: "click->modal#open" },
      class: "btn btn-secondary btn-xs" %>
  </div>

  <ul class="menu menu-sm bg-base-100 rounded-box w-full">
    <% party.addresses.each do |address| %>
      <li class="py-0">
        <div class="flex items-center justify-between">
          <div class="text-sm">
            <div>
              <%= [address.line1, address.line2].compact_blank.join(", ") %>
              <% tail = [address.locality, [address.region_code, address.postal_code].compact_blank.join(" ")].compact_blank.join(", ") %>
              <% if tail.present? %> <br/> <%= tail %><% end %>
              <% if address.country_code.present? %> Â· <%= address.country_code %><% end %>
              <% if address.is_primary %><span class="badge badge-primary badge-sm ml-2 align-middle">Primary</span><% end %>
            </div>
            <div class="opacity-70"><%= address.address_type_code %></div>
          </div>

          <div class="flex gap-1">
            <%= button_to "Primary",
              primary_party_party_address_path(party.public_id, address),
              method: :patch,
              form: { data: { turbo_frame: dom_id(party, :addresses_section) } },
              class: "btn btn-ghost btn-xs" %>

            <%= link_to "Edit",
              edit_party_party_address_path(party.public_id, address, from: :show),
              data: { turbo_frame: "comm_modal_frame", action: "click->modal#open" },
              class: "btn btn-ghost btn-xs" %>

            <%= button_to "Delete",
              party_party_address_path(party.public_id, address),
              method: :delete,
              form: { data: { turbo_confirm: "Delete this address?" } },
              class: "btn btn-ghost btn-xs text-error" %>
          </div>
        </div>
      </li>
    <% end %>
  </ul>
</section>
